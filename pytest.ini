[tool:pytest]
# Configuração do pytest para trilha de testes MrDom SDR

# Diretórios de teste
testpaths = api/tests

# Padrões de arquivos de teste
python_files = test_*.py *_test.py

# Padrões de classes de teste
python_classes = Test*

# Padrões de funções de teste
python_functions = test_*

# Marcadores personalizados
markers =
    e2e: Testes end-to-end da trilha completa
    trilha: Testes da trilha MrDom SDR
    wpp: Testes específicos do WhatsApp
    site: Testes específicos do site
    instagram: Testes específicos do Instagram
    telegram: Testes específicos do Telegram
    n8n: Testes de integração com n8n
    validation: Testes de validação de dados
    followup: Testes de follow-up e reengajamento
    slow: Testes que demoram mais de 5 segundos
    integration: Testes de integração
    unit: Testes unitários

# Configurações de saída
addopts = 
    -v
    --tb=short
    --strict-markers
    --disable-warnings
    --color=yes
    --durations=10

# Configurações de cobertura (se pytest-cov estiver instalado)
# addopts = 
#     --cov=api
#     --cov-report=html
#     --cov-report=term-missing
#     --cov-fail-under=80

# Configurações de timeout (se pytest-timeout estiver instalado)
# timeout = 300
# timeout_method = thread

# Configurações de logging
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Arquivos de log
log_file = test_results/logs/pytest.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] %(filename)s:%(lineno)d %(funcName)s(): %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# Configurações de filtros de warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning:redis.*

# Configurações de fixtures
usefixtures = 
    setup_test_environment
    cleanup_test_environment

# Configurações de plugins
# plugins = 
#     pytest-cov
#     pytest-timeout
#     pytest-mock
#     pytest-asyncio